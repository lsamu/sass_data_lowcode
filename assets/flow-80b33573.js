import{g as B,M as le,_ as te}from"./index-4e766a51.js";import{d as b,b as v,m as ne,E as g}from"./element-plus-990c01d8.js";import{_ as de}from"./index.vue_vue_type_style_index_0_lang-9d936e62.js";import{_ as ae}from"./index.vue_vue_type_style_index_0_lang-98eeb410.js";import{a as ie,r as E}from"./requestUtil-6e906474.js";import{H as se,c as re,a as N,_ as w,d as ce,ah as u,m as ue,p as y,V as n,P as e,u as o,F as me,l as m,U as pe,O as _,T as i,S as k}from"./vue-5a70a57f.js";const fe={class:"box-editor-chart box-lowcode-app"},_e=["onClick"],ke={class:"context-menu"},ge={class:"el-dropdown-link"},ye={class:"dialog-footer"},be={class:"dialog-footer"},ve=se({__name:"flow",setup(we){const I=re().proxy;I.$router,I.$route;const M=ie(),T=N(),c=w({defaultProps:{children:"children",label:"name"},data:M.thatOption.data,selectedNode:null,defaultExpandIds:[]}),H=t=>{c.selectedNode=t,t.kind_type==2},j=t=>{g.success("删除成功")},G=t=>{let l=!1;c.defaultExpandIds.some(p=>{if(p===t.id)return l=!0,!0}),l||c.defaultExpandIds.push(t.id)},J=t=>{c.defaultExpandIds.some((l,p)=>{l===t.id&&c.defaultExpandIds.splice(p,1)}),D(t)},D=t=>{t.children&&t.children.forEach(function(l){const p=c.defaultExpandIds.indexOf(l.id);p>0&&c.defaultExpandIds.splice(p,1),D(l)})},K=(t,l)=>{switch(t){case"newdir":h(null);break;case"renamedir":h(l);break;case"deletedir":L();break;case"new":O(null);break;case"edit":W(l);break;case"rename":O(l);break;case"delete":j();break;case"copyurl":g.success("拷贝地址成功");break;case"qrcode":g.success("二维码地址生成");break}},x=async()=>{const t=await E.request("/admin/lowcode/app","post",{});c.data=t.data.list||[]};ce(()=>{x()});const F=N(),d=w({dialog:{visible:!1,title:"新建目录"},form:{},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}),h=(t=null,l=!1)=>{d.dialog.visible=!0,d.form={},t?(d.dialog.title="重命名",d.form=t):(d.dialog.title="新建目录",l?d.form={kind_type:1}:d.form={kind_type:1,parent_id:c.selectedNode.id})},L=t=>{g.success("删除成功")},Q=()=>{F.value.validate(async t=>{if(t){const l=await E.request("/admin/lowcode/app/create","post",d.form);if(l.code!=0){g.error(l.msg);return}x(),g.success("保存成功"),d.dialog.visible=!1}else return console.log("error submit!"),!1})},q=N(),a=w({dialog:{visible:!1,title:"新建应用"},form:{},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}),O=(t=null)=>{a.dialog.visible=!0,a.form={},t?(a.dialog.title="重命名",a.form=t):(a.dialog.title="新建应用",a.form={kind_type:2,parent_id:c.selectedNode.id,content:{}})},R=()=>{q.value.validate(async t=>{if(t){const l=await E.request("/admin/lowcode/app/create","post",a.form);if(l.code!=0){g.error(l.msg);return}x(),g.success("保存成功"),a.dialog.visible=!1}else return console.log("error submit!"),!1})},V=w({dialog:{visible:!1,title:"可视化"}}),W=(t=null)=>{V.dialog.visible=!0};return(t,l)=>{const p=u("el-button"),C=u("el-input"),$=u("el-col"),U=u("el-row"),X=u("el-icon"),f=u("el-dropdown-item"),Y=u("el-dropdown-menu"),Z=u("el-dropdown"),ee=u("el-tree"),A=u("el-form-item"),P=u("el-form"),z=u("el-dialog"),oe=u("el-drawer");return m(),ue(me,null,[y("div",fe,[n(o(le),{class:"default-theme"},{default:e(()=>[n(o(B),{"min-size":"10",size:"20","max-size":"30"},{default:e(()=>[n(U,null,{default:e(()=>[n($,null,{default:e(()=>[n(C,{placeholder:"输入关键词进行搜索"},{append:e(()=>[n(p,{icon:"Plus",onClick:l[0]||(l[0]=s=>h(null,!0))})]),_:1})]),_:1})]),_:1}),n(U,null,{default:e(()=>[n($,null,{default:e(()=>[n(ee,{data:o(c).data,props:o(c).defaultProps,"expand-on-click-node":!1,"node-key":"id","highlight-current":"","default-expanded-keys":o(c).defaultExpandIds,onNodeExpand:G,onNodeCollapse:J,"default-expand-all":""},{default:e(({node:s,data:r})=>[y("span",{style:{width:"100%"},class:"custom-tree-node",onClick:S=>H(r)},[y("span",null,pe(s.label),1),y("span",ke,[n(Z,{trigger:"click",onCommand:S=>K(S,r)},{dropdown:e(()=>[n(Y,null,{default:e(()=>[r.kind_type==1?(m(),_(f,{key:0,icon:o(b),command:"newdir"},{default:e(()=>[i("新建目录")]),_:1},8,["icon"])):k("",!0),r.kind_type==1?(m(),_(f,{key:1,icon:o(b),command:"renamedir"},{default:e(()=>[i("重命名目录")]),_:1},8,["icon"])):k("",!0),r.kind_type==1?(m(),_(f,{key:2,icon:o(b),command:"deletedir"},{default:e(()=>[i("删除目录")]),_:1},8,["icon"])):k("",!0),r.kind_type==1?(m(),_(f,{key:3,icon:o(b),command:"deletedir"},{default:e(()=>[i("复制链接目录")]),_:1},8,["icon"])):k("",!0),r.kind_type==1?(m(),_(f,{key:4,icon:o(b),command:"new",divided:""},{default:e(()=>[i("新建")]),_:1},8,["icon"])):k("",!0),r.kind_type==2?(m(),_(f,{key:5,icon:o(b),command:"edit"},{default:e(()=>[i("编辑")]),_:1},8,["icon"])):k("",!0),r.kind_type==2?(m(),_(f,{key:6,icon:o(v),command:"copy"},{default:e(()=>[i("复制")]),_:1},8,["icon"])):k("",!0),r.kind_type==2?(m(),_(f,{key:7,icon:o(v),command:"move"},{default:e(()=>[i("移动到")]),_:1},8,["icon"])):k("",!0),r.kind_type==2?(m(),_(f,{key:8,icon:o(v),command:"rename"},{default:e(()=>[i("重命名")]),_:1},8,["icon"])):k("",!0),r.kind_type==2?(m(),_(f,{key:9,icon:o(v),command:"delete"},{default:e(()=>[i("删除")]),_:1},8,["icon"])):k("",!0),r.kind_type==2?(m(),_(f,{key:10,icon:o(v),command:"copyurl",divided:""},{default:e(()=>[i("复制链接")]),_:1},8,["icon"])):k("",!0),r.kind_type==2?(m(),_(f,{key:11,icon:o(v),command:"qrcode"},{default:e(()=>[i("二维码")]),_:1},8,["icon"])):k("",!0)]),_:2},1024)]),default:e(()=>[y("span",ge,[n(X,{size:15},{default:e(()=>[n(o(ne))]),_:1})])]),_:2},1032,["onCommand"])])],8,_e)]),_:1},8,["data","props","default-expanded-keys"])]),_:1})]),_:1})]),_:1}),n(o(B),null,{default:e(()=>[n(de,{ref_key:"refPage",ref:T},null,512)]),_:1})]),_:1})]),n(z,{modelValue:o(d).dialog.visible,"onUpdate:modelValue":l[3]||(l[3]=s=>o(d).dialog.visible=s),title:o(d).dialog.title,width:"30%",draggable:"","append-to-body":""},{footer:e(()=>[y("span",ye,[n(p,{onClick:l[2]||(l[2]=s=>o(d).dialog.visible=!1)},{default:e(()=>[i("取消")]),_:1}),n(p,{type:"primary",onClick:Q},{default:e(()=>[i(" 确定 ")]),_:1})])]),default:e(()=>[n(P,{ref_key:"refDirForm",ref:F,model:o(d).form,"label-width":"120px",rules:o(d).rules},{default:e(()=>[n(A,{label:"目录名称",prop:"name"},{default:e(()=>[n(C,{modelValue:o(d).form.name,"onUpdate:modelValue":l[1]||(l[1]=s=>o(d).form.name=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),n(z,{modelValue:o(a).dialog.visible,"onUpdate:modelValue":l[6]||(l[6]=s=>o(a).dialog.visible=s),title:o(a).dialog.title,width:"30%",draggable:"","append-to-body":""},{footer:e(()=>[y("span",be,[n(p,{onClick:l[5]||(l[5]=s=>o(a).dialog.visible=!1)},{default:e(()=>[i("取消")]),_:1}),n(p,{type:"primary",onClick:R},{default:e(()=>[i(" 确定 ")]),_:1})])]),default:e(()=>[n(P,{ref_key:"refAppForm",ref:q,model:o(a).form,"label-width":"120px",rules:o(a).rules},{default:e(()=>[n(A,{label:"应用名称",prop:"name"},{default:e(()=>[n(C,{modelValue:o(a).form.name,"onUpdate:modelValue":l[4]||(l[4]=s=>o(a).form.name=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),n(oe,{modelValue:o(V).dialog.visible,"onUpdate:modelValue":l[7]||(l[7]=s=>o(V).dialog.visible=s),title:"visualOption.dialog.title","with-header":!1,size:"100%","append-to-body":""},{default:e(()=>[n(ae)]),_:1},8,["modelValue"])],64)}}});const Ie=te(ve,[["__scopeId","data-v-335cec7d"]]);export{Ie as default};
